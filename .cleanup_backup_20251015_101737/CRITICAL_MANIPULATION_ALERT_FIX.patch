--- a/src/monitoring/alert_manager.py
+++ b/src/monitoring/alert_manager.py
@@ -5228,17 +5228,36 @@ class AlertManager:

         elif signal_strength == "CONFLICTING":
             # Calculate manipulation severity based on volume mismatch
-            buy_sell_ratio = whale_buy_volume / max(whale_sell_volume, 1)
+            # CRITICAL FIX: Use parameter names, not undefined variables
+            buy_sell_ratio = buy_volume / max(sell_volume, 1)
             volume_mismatch_severity = self._calculate_manipulation_severity(
-                abs(net_usd_value), whale_trades_count, buy_sell_ratio
+                usd_value, trades_count, buy_sell_ratio
             )

             if subtype == "accumulation":
                 # Order book shows buy orders but actual trades are sells
                 interpretation = self._format_manipulation_alert(
                     pattern="FAKE BUY WALL",
                     orderbook_signal="large BUY orders",
-                    actual_trades=f"{whale_sell_volume:.0f} SELL trades",
+                    actual_trades=f"{sell_volume:.0f} SELL trades",
                     manipulation_tactic="spoofing/fake-walling to create false accumulation",
                     whale_action="selling into the fake demand",
                     risk_scenario="Price may drop suddenly when fake orders are pulled",
                     trader_action="DO NOT FOMO BUY",
                     severity=volume_mismatch_severity,
-                    volume=abs(net_usd_value),
-                    trade_count=whale_trades_count
+                    volume=usd_value,
+                    trade_count=trades_count
                 )
             else:  # distribution
                 # Order book shows sell orders but actual trades are buys
                 interpretation = self._format_manipulation_alert(
                     pattern="FAKE SELL WALL",
                     orderbook_signal="large SELL orders",
-                    actual_trades=f"{whale_buy_volume:.0f} BUY trades",
+                    actual_trades=f"{buy_volume:.0f} BUY trades",
                     manipulation_tactic="spoofing/fake-walling to create false distribution",
                     whale_action="buying the fake dip",
                     risk_scenario="Price may pump suddenly when fake orders are pulled",
                     trader_action="DO NOT PANIC SELL",
                     severity=volume_mismatch_severity,
-                    volume=abs(net_usd_value),
-                    trade_count=whale_trades_count
+                    volume=usd_value,
+                    trade_count=trades_count
                 )

         return interpretation

     def _calculate_manipulation_severity(self, volume: float, trade_count: int, buy_sell_ratio: float) -> str:
         """
         Calculate manipulation severity based on volume, trade count, and buy/sell ratio.
+
+        CRITICAL: Added input validation for production safety.

         Args:
             volume: Total USD volume involved
             trade_count: Number of whale trades
             buy_sell_ratio: Ratio of buy to sell volume (or vice versa)

         Returns:
             Severity level: "EXTREME", "HIGH", "MODERATE", or "LOW"
         """
+        # Input validation - CRITICAL FIX
+        import math
+
+        # Validate finite values
+        if not math.isfinite(volume):
+            self.logger.error(f"Invalid volume in severity calculation: {volume}")
+            return "LOW"  # Fail safe
+
+        if not math.isfinite(buy_sell_ratio):
+            self.logger.error(f"Invalid buy_sell_ratio in severity calculation: {buy_sell_ratio}")
+            return "LOW"  # Fail safe
+
+        # Handle negative values
+        if volume < 0:
+            self.logger.warning(f"Negative volume in severity calculation: {volume}, using absolute value")
+            volume = abs(volume)
+
+        if trade_count < 0:
+            self.logger.warning(f"Negative trade count in severity calculation: {trade_count}, setting to 0")
+            trade_count = 0
+
+        # Zero activity check - CRITICAL FIX
+        if volume < 100_000:  # Less than $100K
+            self.logger.debug(f"Low volume activity in manipulation detection: ${volume:,.0f}")
+            return "LOW"
+
         # Volume-based severity
         volume_severity = 0
         if volume >= 10_000_000:  # $10M+
@@ -5312,6 +5345,13 @@ class AlertManager:

         # Calculate weighted average
         total_severity = (volume_severity * 0.4 + trade_severity * 0.3 + ratio_severity * 0.3)
+
+        # Debug logging - HIGH PRIORITY FIX
+        self.logger.debug(
+            f"Manipulation severity: volume=${volume:,.0f}(sev={volume_severity}), "
+            f"trades={trade_count}(sev={trade_severity}), ratio={buy_sell_ratio:.2f}(sev={ratio_severity}), "
+            f"total={total_severity:.2f}"
+        )

         if total_severity >= 3.5:
             return "EXTREME"
@@ -5353,6 +5393,24 @@ class AlertManager:
         Returns:
             Formatted manipulation alert string
         """
+        # Error handling - HIGH PRIORITY FIX
+        import math
+        try:
+            # Validate inputs
+            if not isinstance(volume, (int, float)) or not math.isfinite(volume):
+                self.logger.error(f"Invalid volume for alert formatting: {volume}")
+                volume = 0
+
+            if not isinstance(trade_count, int) or trade_count < 0:
+                self.logger.error(f"Invalid trade count for alert formatting: {trade_count}")
+                trade_count = 0
+
+        except Exception as e:
+            self.logger.error(f"Error validating alert format inputs: {e}")
+            # Continue with potentially invalid values rather than crash
+            # The formatting will handle them as best as possible
+            pass
+
         # Severity-based emoji and risk level
         severity_config = {
             "EXTREME": {"emoji": "ðŸš¨ðŸš¨ðŸš¨", "risk": "CRITICAL", "urgency": "IMMEDIATE ATTENTION REQUIRED"},
