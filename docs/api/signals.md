# Signals API

The Signals API provides access to trading signals generated by the Virtuoso Trading System. These signals are based on multi-factor analysis using the Market Prism methodology and offer high-probability trading opportunities.

## Endpoints

### Get Latest Signals

```
GET /api/signals/latest
```

Retrieves the most recent trading signals.

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `limit` | Integer | Maximum number of signals to return (default: 10, max: 100) |
| `signal_type` | String | Filter by signal type: "BULLISH", "BEARISH", "NEUTRAL" (optional) |
| `min_score` | Integer | Minimum score threshold (0-100) (optional) |
| `include_pdf` | Boolean | Whether to include PDF report as base64 (default: false) |
| `include_chart` | Boolean | Whether to include chart image as base64 (default: false) |

#### Response

```json
{
  "success": true,
  "data": [
    {
      "id": "sig_1234567890",
      "timestamp": "2023-06-15T14:30:00Z",
      "symbol": "BTCUSDT",
      "exchange": "bybit",
      "signal_type": "BULLISH",
      "score": 85,
      "reliability": 92,
      "timeframe": "1h",
      "entry_price": 34500,
      "stop_loss": 34100,
      "take_profit": [35500, 36000, 36500],
      "risk_reward": 3.33,
      "components": {
        "technical": 82,
        "volume": 88,
        "orderflow": 85,
        "orderbook": 90,
        "price_structure": 78,
        "sentiment": 72
      },
      "file_paths": {
        "json": "reports/json/BTCUSDT_20230615_143000.json",
        "pdf": "reports/pdf/BTCUSDT_20230615_143000.pdf",
        "chart": "reports/charts/BTCUSDT_20230615_143000.png"
      },
      "pdf_base64": "...", // Only included if include_pdf=true
      "chart_base64": "..." // Only included if include_chart=true
    },
    // More signals...
  ],
  "timestamp": 1647356789123,
  "count": 10,
  "total": 156
}
```

### Get Signals for a Symbol

```
GET /api/signals/symbol/{symbol}
```

Retrieves signals for a specific trading pair.

#### Path Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `symbol` | String | Trading pair (e.g., "BTCUSDT") |

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `limit` | Integer | Maximum number of signals to return (default: 10, max: 100) |
| `signal_type` | String | Filter by signal type: "BULLISH", "BEARISH", "NEUTRAL" (optional) |
| `min_score` | Integer | Minimum score threshold (0-100) (optional) |
| `start_time` | ISO DateTime | Start time for filtering signals (optional) |
| `end_time` | ISO DateTime | End time for filtering signals (optional) |
| `include_pdf` | Boolean | Whether to include PDF report as base64 (default: false) |
| `include_chart` | Boolean | Whether to include chart image as base64 (default: false) |

#### Response

Same format as the `/api/signals/latest` endpoint.

### Get Paginated Signals List

```
GET /api/signals
```

Retrieves a paginated list of signals with extensive filtering options.

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `page` | Integer | Page number (default: 1) |
| `size` | Integer | Number of results per page (default: 10, max: 100) |
| `symbol` | String | Filter by trading pair (optional) |
| `exchange` | String | Filter by exchange (optional) |
| `signal_type` | String | Filter by signal type: "BULLISH", "BEARISH", "NEUTRAL" (optional) |
| `min_score` | Integer | Minimum score threshold (0-100) (optional) |
| `min_reliability` | Integer | Minimum reliability threshold (0-100) (optional) |
| `timeframe` | String | Filter by timeframe (optional) |
| `start_time` | ISO DateTime | Start time for filtering signals (optional) |
| `end_time` | ISO DateTime | End time for filtering signals (optional) |
| `sort_by` | String | Field to sort by (default: "timestamp") |
| `sort_order` | String | Sort order: "asc" or "desc" (default: "desc") |
| `include_pdf` | Boolean | Whether to include PDF report as base64 (default: false) |
| `include_chart` | Boolean | Whether to include chart image as base64 (default: false) |

#### Response

```json
{
  "success": true,
  "data": [
    // Signal objects as in the previous endpoints
  ],
  "timestamp": 1647356789123,
  "pagination": {
    "page": 1,
    "size": 10,
    "total_pages": 16,
    "total_items": 156
  }
}
```

### Get Signal by Filename

```
GET /api/signals/file/{filename}
```

Retrieves a specific signal by its filename.

#### Path Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `filename` | String | Signal filename (without extension) |

#### Query Parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `include_pdf` | Boolean | Whether to include PDF report as base64 (default: false) |
| `include_chart` | Boolean | Whether to include chart image as base64 (default: false) |

#### Response

```json
{
  "success": true,
  "data": {
    // Single signal object as in the previous endpoints
  },
  "timestamp": 1647356789123
}
```

## Signal Object Structure

The signal object contains the following fields:

| Field | Type | Description |
|-------|------|-------------|
| `id` | String | Unique identifier for the signal |
| `timestamp` | ISO DateTime | When the signal was generated |
| `symbol` | String | Trading pair (e.g., "BTCUSDT") |
| `exchange` | String | Exchange identifier |
| `signal_type` | String | "BULLISH", "BEARISH", or "NEUTRAL" |
| `score` | Integer | Overall signal score (0-100) |
| `reliability` | Integer | Reliability score (0-100) |
| `timeframe` | String | Timeframe of the analysis |
| `entry_price` | Number | Suggested entry price |
| `stop_loss` | Number | Suggested stop loss level |
| `take_profit` | Array | Array of take profit targets |
| `risk_reward` | Number | Calculated risk-to-reward ratio |
| `components` | Object | Scores for individual components |
| `file_paths` | Object | Paths to related files |
| `pdf_base64` | String | Base64-encoded PDF report (optional) |
| `chart_base64` | String | Base64-encoded chart image (optional) |

## Error Codes

| Code | Description |
|------|-------------|
| 400 | Bad request (invalid parameters) |
| 404 | Signal not found |
| 429 | Rate limit exceeded |
| 500 | Internal server error |

## Example Usage

### Python

```python
import requests

# Get the latest 5 signals
response = requests.get("http://your-server/api/signals/latest?limit=5")
latest_signals = response.json()

# Get signals for a specific symbol
symbol = "BTCUSDT"
response = requests.get(f"http://your-server/api/signals/symbol/{symbol}")
symbol_signals = response.json()

# Get signals with filtering
params = {
    "symbol": "ETHUSDT",
    "signal_type": "BULLISH",
    "min_score": 75,
    "page": 1,
    "size": 10
}
response = requests.get("http://your-server/api/signals", params=params)
filtered_signals = response.json()
```

### JavaScript

```javascript
// Get the latest 5 signals
fetch("http://your-server/api/signals/latest?limit=5")
  .then(response => response.json())
  .then(data => console.log(data));

// Get signals for a specific symbol
const symbol = "BTCUSDT";
fetch(`http://your-server/api/signals/symbol/${symbol}`)
  .then(response => response.json())
  .then(data => console.log(data));

// Get signals with filtering
const params = new URLSearchParams({
  symbol: "ETHUSDT",
  signal_type: "BULLISH",
  min_score: 75,
  page: 1,
  size: 10
});
fetch(`http://your-server/api/signals?${params}`)
  .then(response => response.json())
  .then(data => console.log(data));
``` 