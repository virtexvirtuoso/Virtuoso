# Optuna Optimization Configuration for Virtuoso Trading System
# Complete parameter optimization targeting 1,247 system parameters

# Study Configuration
studies:
  technical_indicators:
    direction: maximize
    sampler: TPE
    pruner: MedianPruner
    n_trials: 200
    timeout: 7200  # 2 hours
    evaluation_period_days: 90
    
  volume_indicators:
    direction: maximize
    sampler: TPE
    pruner: MedianPruner
    n_trials: 150
    timeout: 5400  # 1.5 hours
    evaluation_period_days: 90
    
  orderbook_indicators:
    direction: maximize
    sampler: TPE
    pruner: HyperbandPruner
    n_trials: 300
    timeout: 10800  # 3 hours
    evaluation_period_days: 60
    
  orderflow_indicators:
    direction: maximize
    sampler: TPE
    pruner: MedianPruner
    n_trials: 250
    timeout: 9000  # 2.5 hours
    evaluation_period_days: 60
    
  sentiment_indicators:
    direction: maximize
    sampler: TPE
    pruner: PercentilePruner
    n_trials: 100
    timeout: 3600  # 1 hour
    evaluation_period_days: 90
    
  price_structure_indicators:
    direction: maximize
    sampler: TPE
    pruner: MedianPruner
    n_trials: 180
    timeout: 6300  # 1.75 hours
    evaluation_period_days: 90
    
  confluence_weights:
    direction: maximize
    sampler: TPE
    pruner: HyperbandPruner
    n_trials: 400
    timeout: 14400  # 4 hours
    evaluation_period_days: 120
    
  risk_management:
    direction: maximize
    sampler: CmaEs  # Good for risk optimization
    pruner: MedianPruner
    n_trials: 150
    timeout: 5400  # 1.5 hours
    evaluation_period_days: 180  # Longer for risk assessment
    
  signal_generation:
    direction: maximize
    sampler: TPE
    pruner: HyperbandPruner
    n_trials: 200
    timeout: 7200  # 2 hours
    evaluation_period_days: 90

# Sampler Configuration
samplers:
  n_startup_trials: 20
  n_ei_candidates: 24
  multivariate: true
  group: false
  warn_independent_sampling: true

# Pruner Configuration  
pruners:
  median_n_startup_trials: 5
  median_n_warmup_steps: 10
  percentile_threshold: 25.0
  hyperband_min_resource: 1
  hyperband_reduction_factor: 3

# Objective Function Configuration
objectives:
  risk_free_rate: 0.02  # 2% annual risk-free rate
  min_trades_threshold: 100  # Minimum trades for valid optimization
  evaluation_period_days: 90  # Default evaluation period
  
  # Multi-objective weights
  objective_weights:
    return: 0.30
    sharpe: 0.25
    drawdown: 0.20  # Lower drawdown is better
    win_rate: 0.15
    trades: 0.10  # Sufficient trade volume
  
  # Market regime specific weights
  regime_weights:
    trending:
      return: 0.4
      sharpe: 0.6
    ranging:
      win_rate: 0.5
      drawdown: 0.5
    volatile:
      sortino: 0.6
      drawdown: 0.4
    low_volatility:
      return: 0.7
      profit_factor: 0.3

# Database Configuration
database:
  url: "sqlite:///data/optuna_studies.db"
  engine_kwargs:
    pool_size: 10
    max_overflow: 20
    
# Dashboard Configuration
dashboard:
  host: "127.0.0.1"
  port: 8080
  debug: false
  
# Parallel Optimization
parallel:
  max_workers: 4  # Adjust based on CPU cores
  distributed: false
  
# Advanced Features
advanced:
  enable_intermediate_values: true
  enable_study_user_attrs: true
  enable_trial_user_attrs: true
  
  # Automated parameter importance analysis
  parameter_importance:
    enabled: true
    evaluator: "fanova"  # or "permutation"
    
  # Multi-objective optimization
  multi_objective:
    enabled: false  # Start with single objective
    directions: ["maximize", "minimize"]  # Return, Drawdown
    
  # Hyperparameter evolution
  evolution:
    enabled: false  # Advanced feature for later
    population_size: 50
    n_generations: 100

# Integration Settings
integration:
  # Enable real-time optimization
  real_time_optimization: false
  real_time_update_interval: 3600  # 1 hour
  
  # Parameter deployment
  auto_deploy_best_params: false
  deployment_confidence_threshold: 0.95
  
  # Monitoring and alerts
  monitoring:
    enabled: true
    alert_on_significant_improvement: true
    improvement_threshold: 0.05  # 5% improvement
    
# Logging Configuration
logging:
  level: INFO
  log_file: "logs/optuna_optimization.log"
  detailed_trial_logging: false
  
# Development/Testing
development:
  mock_backtesting: true  # Use mock data for development
  quick_trials: false  # Reduced trials for testing
  debug_parameter_spaces: false